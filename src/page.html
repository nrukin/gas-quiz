<!DOCTYPE html>
<html>
  <head>
    <script>
      function preventFormSubmit() {
	  var forms = document.querySelectorAll('form');
	  for (var i = 0; i < forms.length; i++) {
	      forms[i].addEventListener('submit', function(event) {
		  event.preventDefault();
	      });
	  }
      }
      window.addEventListener('load', preventFormSubmit);

      function handleFormSubmit(formObject) {
	  google.script.run.withSuccessHandler(showResult).processForm(formObject);
	  document.getElementById("submit").disabled = true;
      }

      function showResult(result) {
	  var div = document.getElementById('output');
	  div.innerHTML = result;
      }
    </script>
  <head>
    <body>
      <h1><?= data.title ?></h1>
      <form onsubmit="handleFormSubmit(this)">
	<div>
	  <label for="name">Ваше имя:</label>
	  <input type="text" id="name" name="name" required/>
	</div>
	<? for (var i = 0; i < data.questions.length; i++) { ?>
	<div>
	  <fieldset>
	    <legend><?= data.questions[i].text ?></legend>
	    <? for (var j = 0; j < data.questions[i].answers.length; j++) { ?>
            <? var answerID = data.questions[i].id + "_" + j ?>
            <div>
              <input type="radio" id=<?= answerID ?> name=<?= data.questions[i].id ?> value=<?= j ?> />
              <label for=<?= answerID ?>><?= data.questions[i].answers[j] ?></label>
            </div>
	    <? } ?>
	  </fieldset>
	</div>
	<? } ?>
	<div><input type="submit" id="submit" value="Завершить тест" /></div>
      </form>
      <div class="result" id="output"></div>
    </body>
</html>
